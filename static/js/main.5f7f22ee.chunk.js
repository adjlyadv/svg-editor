(this["webpackJsonpsvg-editor"]=this["webpackJsonpsvg-editor"]||[]).push([[0],{23:function(t,e,s){},28:function(t,e,s){},29:function(t,e,s){},30:function(t,e,s){},31:function(t,e,s){},32:function(t,e,s){},33:function(t,e,s){},34:function(t,e,s){"use strict";s.r(e);var o=s(0),c=s(1),n=s.n(c),r=s(15),a=s.n(r),i=(s(23),s(3)),l=s(4),u=s(11),d=s(16),p=s(2),h=0,j=1,b=2,f=new function t(){var e=this;Object(d.a)(this,t),this.editorInfo={width:800,height:600,left:0,top:0},this.mouseState={type:h,drugging:!1,pathid:0,nodeid:0},this.pathList=[],this.addPath=function(){return e.pathList.push({id:e.pathList.length,nodes:[],strokeWidth:5,stroke:"#000000",fill:"#ffffff"}),e.pathList.length-1},this.deletePath=function(t){delete e.pathList[t]},this.setNodes=function(t,s,o){e.pathList[t].nodes[s]=o},this.addNodes=function(t,s,o,c,n,r,a,i){var l=e.pathList[t].nodes.length;0===l?e.pathList[t].nodes.push({posX:s,posY:o,ctrPosX:c||s,ctrPosY:n||o}):e.pathList[t].nodes=[].concat(Object(u.a)(e.pathList[t].nodes.slice(0,i||l-1)),[{posX:s,posY:o,ctrPosX:c||s,ctrPosY:n||o,ctr2PosX:r,ctr2PosY:a}],Object(u.a)(e.pathList[t].nodes.slice(i||l-1)))},this.setMouseState=function(t,s,o,c){e.mouseState.pathid=o,e.mouseState.nodeid=c,e.mouseState.type=t,e.mouseState.drugging=s},this.setStateInfo=function(t,s,o){switch(s){case"X":var c=e.pathList[0].nodes[0];c.posX=Number(o),e.setNodes(0,0,c);break;case"Y":var n=e.pathList[0].nodes[0];n.posY=Number(o),e.setNodes(0,0,n);break;case"fill":e.pathList[t].fill=o;break;case"strokeWidth":e.pathList[t].strokeWidth=Number(o);break;case"stroke":e.pathList[t].stroke=o}},Object(p.k)(this),this.pathList.push({id:0,nodes:[{posX:125.5,posY:171.5,ctrPosX:194.5,ctrPosY:85.5},{posX:246.5,posY:140.5,ctrPosX:288.5,ctrPosY:95.5,ctr2PosX:204.5,ctr2PosY:185.5},{posX:210,posY:261,ctrPosX:309.5,ctrPosY:309.5}],strokeWidth:5,stroke:"#000000",fill:"#ffffff"})};function P(t){var e=f.editorInfo;return{x:t.clientX-e.left,y:t.clientY-e.top}}var O=s(5),m=Object(O.a)((function(t){if(-1===t.id)return Object(o.jsx)("circle",{onClick:t.onClick,onMouseLeave:t.onMouseLeave,className:"point-control-add",cx:t.node.posX,cy:t.node.posY});var e=f.pathList[t.pathId].nodes[t.id],s=function(e,s){switch(e){case h:f.setMouseState(h,!0,t.pathId,t.id);break;case j:f.setMouseState(j,!0,t.pathId,t.id);break;case b:f.setMouseState(b,!0,t.pathId,t.id)}};return Object(o.jsxs)(c.Fragment,{children:[Object(o.jsx)("circle",{className:"point-control",onMouseDown:function(t){return s(h)},cx:e.posX,cy:e.posY}),Object(o.jsx)("line",{x1:e.posX,y1:e.posY,x2:e.ctrPosX,y2:e.ctrPosY,stroke:"#555",strokeWidth:"1"}),Object(o.jsx)("circle",{className:"point-control",onMouseDown:function(t){return s(j)},cx:e.ctrPosX,cy:e.ctrPosY}),e.ctr2PosX&&e.ctr2PosY&&Object(o.jsx)("circle",{className:"point-control",onMouseDown:function(t){return s(b)},cx:e.ctr2PosX,cy:e.ctr2PosY}),e.ctr2PosX&&e.ctr2PosY&&Object(o.jsx)("line",{x1:e.posX,y1:e.posY,x2:e.ctr2PosX,y2:e.ctr2PosY,stroke:"#555",strokeWidth:"1"})]})})),x=s(8),X=s.n(x),Y=s(17),v=s.n(Y),g=Object(O.a)((function(t){var e=function(t){var e="";if(1===t.length)return e;for(var s=0;s<t.length;s++)0===s?e+="M ".concat(t[s].posX," ").concat(t[s].posY," C ").concat(t[s].ctrPosX," ").concat(t[s].ctrPosY," "):s+1<=t.length-1?e+="".concat(t[s].ctrPosX," ").concat(t[s].ctrPosY," ").concat(t[s].posX," ").concat(t[s].posY," C ").concat(t[s].ctr2PosX," ").concat(t[s].ctr2PosY," "):e+="".concat(t[s].ctrPosX," ").concat(t[s].ctrPosY," ").concat(t[s].posX," ").concat(t[s].posY);return console.log(e),e},s=function(e){e.stopPropagation(),t.setPathid(t.path.id)},n=X.a.throttle((function(t,e){t.stopPropagation();var s=P(t),o=s.x,c=s.y,n=e.nodes.reduce((function(t,s,o){return o===e.nodes.length-1?t.push(s.ctrPosX,s.ctrPosY,s.posX,s.posY):t.push(s.posX,s.posY,s.ctrPosX,s.ctrPosY),t}),[]).flat(1),r=new v.a(n);Y(r);var a=r.project({x:o,y:c});j({posX:a.x,posY:a.y,ctrPosX:a.x,ctrPosY:a.y,t:a.t})}),50),r=Object(c.useState)(!1),a=Object(i.a)(r,2),l=a[0],u=a[1],d=Object(c.useState)(),p=Object(i.a)(d,2),h=p[0],j=p[1],b=Object(c.useState)(),O=Object(i.a)(b,2),x=O[0],Y=O[1],g=t.path,k=g.id,N=g.nodes;if(!l)return Object(o.jsx)(c.Fragment,{children:Object(o.jsx)("path",{onDoubleClick:function(e){e.stopPropagation(),"mouse"===t.currentTool&&u(!0)},onClick:s,d:e(N),strokeWidth:t.path.strokeWidth,stroke:t.path.stroke,fill:t.path.fill})});var y=function(){for(var t=[],s=null,o=0;o+1<N.length;o++){if(0!==o&&o+1!==N.length){var c=N[o];s={posX:c.posX,posY:c.posY,ctrPosX:c.ctr2PosX,ctrPosY:c.ctr2PosY}}var n=e([s||N[o],N[o+1]]);t.push({attrD:n,nodes:[s||N[o],N[o+1]]})}return t}();return Object(o.jsxs)(c.Fragment,{children:[y.map((function(e){return Object(o.jsx)(c.Fragment,{children:Object(o.jsx)("path",{onClick:s,d:e.attrD,onMouseOver:function(t){return n(t,e)},strokeWidth:t.path.strokeWidth,stroke:t.path.stroke,fill:t.path.fill},e.attrD)})})),N.map((function(t,e){return Object(o.jsx)(m,{node:t,id:e,pathId:k})})),h&&Object(o.jsx)(m,{node:h,id:-1,pathId:-1,onClick:function(){var t=null===x||void 0===x?void 0:x.split(h.t),e=null===t||void 0===t?void 0:t.left.points;if(t&&e){var s=N.findIndex((function(t){return t.posX===(null===x||void 0===x?void 0:x.points[0].x)&&t.posY===(null===x||void 0===x?void 0:x.points[0].y)})),o={posX:e[0].x,posY:e[0].y,ctrPosX:s?f.pathList[k].nodes[s].ctrPosX:e[1].x,ctrPosY:s?f.pathList[k].nodes[s].ctrPosY:e[1].y,ctr2PosX:s?e[1].x:void 0,ctr2PosY:s?e[1].y:void 0},c={posX:e[3].x,posY:e[3].y,ctrPosX:e[2].x,ctrPosY:e[2].y,ctr2PosX:0,ctr2PosY:0};f.setNodes(k,s,o),o={posX:(e=null===t||void 0===t?void 0:t.right.points)[3].x,posY:e[3].y,ctrPosX:e[2].x,ctrPosY:e[2].y,ctr2PosX:f.pathList[k].nodes[s+1].ctr2PosX||void 0,ctr2PosY:f.pathList[k].nodes[s+1].ctr2PosY||void 0},c.ctr2PosX=e[1].x,c.ctr2PosY=e[1].y,f.setNodes(k,s+1,o),f.addNodes(k,c.posX,c.posY,c.ctrPosX,c.ctrPosY,c.ctr2PosX,c.ctr2PosY,s+1),j(null)}},onMouseLeave:function(){return j(null)}})]})})),k=(s(28),function(t){Object(c.useEffect)((function(){var t;if(e){var s=null===e||void 0===e||null===(t=e.current)||void 0===t?void 0:t.getBoundingClientRect();s&&(f.editorInfo.top=s.top,f.editorInfo.left=s.left,m(s))}}),[]);var e=Object(c.useRef)(null),s=Object(c.useRef)(!1),n=Object(c.useState)(-1),r=Object(i.a)(n,2),a=r[0],u=r[1],d=Object(c.useState)(f.editorInfo),p=Object(i.a)(d,2),O=p[0],m=p[1],X=Object(c.useState)(!1),Y=Object(i.a)(X,2),v=Y[0],k=Y[1],N=f.pathList,y=f.mouseState.pathid,L=f.mouseState.nodeid,S=Object(c.useState)(N[f.mouseState.pathid].nodes[f.mouseState.nodeid]),I=Object(i.a)(S,2),C=I[0],T=I[1];Object(c.useEffect)((function(){f.setNodes(f.mouseState.pathid,f.mouseState.nodeid,C)}),[C]),Object(c.useEffect)((function(){if("pen"!==t.currentTool){var e=a;-1!==e&&f.pathList[e].nodes.length<2?(f.deletePath(e),s.current=!1,u(-1)):-1!==e&&f.pathList[e].nodes.length>=2&&(s.current=!1,u(-1))}console.log(f.pathList)}),[t.currentTool,a]);var M,w=Object(c.useState)(N[y].nodes[L]),W=Object(i.a)(w,2),D=W[0],F=W[1],E=Object(c.useState)(N[y].nodes[L]),B=Object(i.a)(E,2),R=B[0],J=B[1],A=x.debounce((function(e){e.stopPropagation();var o=P(e),c=o.x,n=o.y;switch(t.currentTool){case"mouse":if(!f.mouseState.drugging)return;switch(f.mouseState.type){case h:T(Object(l.a)(Object(l.a)({},C),{},{posX:c,posY:n}));break;case j:T(Object(l.a)(Object(l.a)({},C),{},{ctrPosX:c,ctrPosY:n}));break;case b:T(Object(l.a)(Object(l.a)({},C),{},{ctr2PosX:c,ctr2PosY:n}))}break;case"pen":s.current&&F(Object(l.a)(Object(l.a)({},D),{},{ctrPosX:c,ctrPosY:n}))}}),5,{trailing:!0});return Object(o.jsx)("div",{className:"editor-container",children:Object(o.jsxs)("svg",{ref:e,className:"editor-svg",width:O.width,height:O.height,onMouseDown:function(e){e.stopPropagation();var o=P(e),c=o.x,n=o.y;switch(t.currentTool){case"mouse":y=f.mouseState.pathid,L=f.mouseState.nodeid;var r=f.pathList[y].nodes[L];T(Object(l.a)({},r));break;case"pen":s.current||(s.current=!0,k(!0),J({posX:c,posY:n,ctrPosX:c,ctrPosY:n,ctr2PosX:c,ctr2PosY:n})),F({posX:c,posY:n,ctrPosX:c,ctrPosY:n,ctr2PosX:c,ctr2PosY:n})}},onMouseMove:A,onMouseUp:function(e){e.stopPropagation(),clearTimeout(M),M=setTimeout((function(){switch(t.currentTool){case"mouse":f.setMouseState(h,!1,y,L);break;case"pen":if(!s.current)return;var e=a;-1===a&&(e=f.addPath(),u(e));var o=f.pathList[e].nodes.length,c=2*D.posX-D.ctrPosX,n=2*D.posY-D.ctrPosY;f.addNodes(e,D.posX,D.posY,D.ctrPosX,D.ctrPosY,c,n,o),v?(J(Object(l.a)(Object(l.a)({},D),{},{ctrPosX:c,ctrPosY:n})),k(!1)):J(Object(l.a)({},D)),console.log(f.pathList)}}),250)},onDoubleClick:function(){clearTimeout(M),s.current=!1,u(-1)},children:[N.map((function(e){return Object(o.jsx)(g,{path:e,setPathid:t.set,currentTool:t.currentTool},e.id)})),function(){if(s.current){var t=2*R.posX-R.ctrPosX,e=2*R.posY-R.ctrPosY,n="M ".concat(R.posX," ").concat(R.posY," C ").concat(t," ").concat(e," ").concat(D.ctrPosX," ").concat(D.ctrPosY),r=0;return R.posX!==D.posX&&R.posY!==D.posY?(n+=" ".concat(D.posX," ").concat(D.posY),r=1):(n+=" ".concat(D.ctrPosX," ").concat(D.ctrPosY),r=0),Object(o.jsxs)(c.Fragment,{children:[Object(o.jsx)("path",{d:n,fill:"none",stroke:"#000",strokeWidth:"1"}),Object(o.jsx)("circle",{className:"point-control",cx:D.posX,cy:D.posY,stroke:"#55f",r:"10"}),Object(o.jsx)("line",{x1:D.posX,y1:D.posY,x2:D.ctrPosX,y2:D.ctrPosY,stroke:"#555",strokeWidth:r}),Object(o.jsx)("circle",{className:"point-control",cx:D.ctrPosX,cy:D.ctrPosY,stroke:"#000",r:"10"})]})}}()]})})}),N=(s(29),Object(O.a)((function(t){var e=function(e){var s=e.target.name,o=e.target.value;f.setStateInfo(t.currentPathid,s,o)},s=f.pathList[t.currentPathid];return Object(o.jsx)(c.Fragment,{children:Object(o.jsxs)("div",{className:"statusContainer",children:[Object(o.jsx)("h4",{children:"\u72b6\u6001\u680f"}),Object(o.jsxs)("label",{className:"statusinput",children:[Object(o.jsx)("span",{children:"PositionX:"}),Object(o.jsx)("input",{type:"number",name:"X",value:s.nodes[0].posX,onChange:e})]}),Object(o.jsxs)("label",{className:"statusinput",children:[Object(o.jsx)("span",{children:"PositionY:"}),Object(o.jsx)("input",{type:"number",name:"Y",value:s.nodes[0].posY,onChange:e})]}),Object(o.jsxs)("label",{className:"statusinput",children:[Object(o.jsx)("span",{children:"fill:"}),Object(o.jsx)("input",{type:"color",name:"fill",value:s.fill,onChange:e})]}),Object(o.jsxs)("label",{className:"statusinput",children:[Object(o.jsx)("span",{children:"stroke Width:"}),Object(o.jsx)("input",{type:"number",name:"strokeWidth",min:"0",max:"40",value:s.strokeWidth,onChange:e})]}),Object(o.jsxs)("label",{className:"statusinput",children:[Object(o.jsx)("span",{children:"stroke:"}),Object(o.jsx)("input",{type:"color",name:"stroke",value:s.stroke,onChange:e})]})]})})}))),y=(s(30),s(31),s.p+"static/media/circle.292ce4e1.svg"),L=s.p+"static/media/pen.4de46a1c.svg",S=s.p+"static/media/mouse.dfeff54d.svg",I=s.p+"static/media/line.86048c7a.svg",C=s.p+"static/media/rectangle.d8ea8f58.svg",T=function(t){function e(e){t.set(e.target.id)}return Object(o.jsxs)("div",{className:"toolbar",children:[Object(o.jsx)("div",{className:"toolitem",onClick:e,children:Object(o.jsx)("img",{className:"mouse"===t.currentTool?"itmeIconselect":"itmeIcon",id:"mouse",alt:"mouse",src:S})}),Object(o.jsx)("div",{className:"toolitem",onClick:e,children:Object(o.jsx)("img",{className:"circle"===t.currentTool?"itmeIconselect":"itmeIcon",id:"circle",alt:"circle",src:y})}),Object(o.jsx)("div",{className:"toolitem",onClick:e,children:Object(o.jsx)("img",{className:"rectangle"===t.currentTool?"itmeIconselect":"itmeIcon",id:"rectangle",alt:"rectangle",src:C})}),Object(o.jsx)("div",{className:"toolitem",onClick:e,children:Object(o.jsx)("img",{className:"line"===t.currentTool?"itmeIconselect":"itmeIcon",id:"line",alt:"line",src:I})}),Object(o.jsx)("div",{className:"toolitem",onClick:e,children:Object(o.jsx)("img",{className:"pen"===t.currentTool?"itmeIconselect":"itmeIcon",id:"pen",alt:"pen",src:L})})]})},M=(s(32),function(){var t=Object(c.useState)("mouse"),e=Object(i.a)(t,2),s=e[0],n=e[1],r=Object(c.useState)(0),a=Object(i.a)(r,2),l=a[0],u=a[1];return Object(o.jsxs)("div",{className:"basic-container",children:[Object(o.jsx)(T,{currentTool:s,set:n}),Object(o.jsx)(k,{currentTool:s,currentPathid:l,set:u}),Object(o.jsx)(N,{currentPathid:l})]})});s(33);var w=function(){return Object(o.jsx)("div",{className:"App",children:Object(o.jsx)(M,{})})},W=function(t){t&&t instanceof Function&&s.e(3).then(s.bind(null,35)).then((function(e){var s=e.getCLS,o=e.getFID,c=e.getFCP,n=e.getLCP,r=e.getTTFB;s(t),o(t),c(t),n(t),r(t)}))};a.a.render(Object(o.jsx)(n.a.StrictMode,{children:Object(o.jsx)(w,{})}),document.getElementById("root")),W()}},[[34,1,2]]]);
//# sourceMappingURL=main.5f7f22ee.chunk.js.map