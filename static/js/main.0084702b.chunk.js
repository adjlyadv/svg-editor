(this["webpackJsonpsvg-editor"]=this["webpackJsonpsvg-editor"]||[]).push([[0],{23:function(t,e,s){},28:function(t,e,s){},29:function(t,e,s){},30:function(t,e,s){},31:function(t,e,s){},32:function(t,e,s){},33:function(t,e,s){},34:function(t,e,s){"use strict";s.r(e);var o=s(0),c=s(1),n=s.n(c),i=s(15),r=s.n(i),a=(s(23),s(3)),l=s(4),u=s(11),d=s(16),p=s(2),h=0,j=1,b=2,f=new function t(){var e=this;Object(d.a)(this,t),this.editorInfo={width:800,height:600,left:0,top:0},this.mouseState={type:h,drugging:!1,pathid:0,nodeid:0},this.pathList=[],this.addPath=function(){return e.pathList.push({id:e.pathList.length-1,nodes:[],strokeWidth:5,stroke:"#000000",fill:"#ffffff"}),e.pathList.length-1},this.setNodes=function(t,s,o){e.pathList[t].nodes[s]=o},this.addNodes=function(t,s,o,c,n,i,r,a){var l=e.pathList[t].nodes.length;e.pathList[t].nodes=[].concat(Object(u.a)(e.pathList[t].nodes.slice(0,a||l-1)),[{posX:s,posY:o,ctrPosX:c||s,ctrPosY:n||o,ctr2PosX:i,ctr2PosY:r}],Object(u.a)(e.pathList[t].nodes.slice(a||l-1)))},this.setMouseState=function(t,s,o,c){e.mouseState.pathid=o,e.mouseState.nodeid=c,e.mouseState.type=t,e.mouseState.drugging=s},this.setStateInfo=function(t,s,o){switch(s){case"X":var c=e.pathList[0].nodes[0];c.posX=Number(o),e.setNodes(0,0,c);break;case"Y":var n=e.pathList[0].nodes[0];n.posY=Number(o),e.setNodes(0,0,n);break;case"fill":e.pathList[t].fill=o;break;case"strokeWidth":e.pathList[t].strokeWidth=Number(o);break;case"stroke":e.pathList[t].stroke=o}},Object(p.k)(this),this.pathList.push({id:0,nodes:[{posX:125.5,posY:171.5,ctrPosX:194.5,ctrPosY:85.5},{posX:246.5,posY:140.5,ctrPosX:288.5,ctrPosY:95.5,ctr2PosX:204.5,ctr2PosY:185.5},{posX:210,posY:261,ctrPosX:309.5,ctrPosY:309.5}],strokeWidth:5,stroke:"#000000",fill:"#ffffff"})};function m(t){var e=f.editorInfo;return{x:t.clientX-e.left,y:t.clientY-e.top}}var P=s(5),O=Object(P.a)((function(t){if(-1===t.id)return Object(o.jsx)("circle",{onClick:t.onClick,onMouseLeave:t.onMouseLeave,className:"point-control-add",cx:t.node.posX,cy:t.node.posY});var e=f.pathList[t.pathId].nodes[t.id],s=function(e,s){switch(e){case h:f.setMouseState(h,!0,t.pathId,t.id);break;case j:f.setMouseState(j,!0,t.pathId,t.id);break;case b:f.setMouseState(b,!0,t.pathId,t.id)}};return Object(o.jsxs)(c.Fragment,{children:[Object(o.jsx)("circle",{className:"point-control",onMouseDown:function(t){return s(h)},cx:e.posX,cy:e.posY}),Object(o.jsx)("line",{x1:e.posX,y1:e.posY,x2:e.ctrPosX,y2:e.ctrPosY,stroke:"#555",strokeWidth:"1"}),Object(o.jsx)("circle",{className:"point-control",onMouseDown:function(t){return s(j)},cx:e.ctrPosX,cy:e.ctrPosY}),e.ctr2PosX&&e.ctr2PosY&&Object(o.jsx)("circle",{className:"point-control",onMouseDown:function(t){return s(b)},cx:e.ctr2PosX,cy:e.ctr2PosY}),e.ctr2PosX&&e.ctr2PosY&&Object(o.jsx)("line",{x1:e.posX,y1:e.posY,x2:e.ctr2PosX,y2:e.ctr2PosY,stroke:"#555",strokeWidth:"1"})]})})),x=s(8),v=s.n(x),X=s(17),Y=s.n(X),g=Object(P.a)((function(t){var e=function(t){for(var e="",s=0;s<t.length;s++)0===s?e+="M ".concat(t[s].posX," ").concat(t[s].posY," C ").concat(t[s].ctrPosX," ").concat(t[s].ctrPosY," "):s+1<=t.length-1?e+="".concat(t[s].ctrPosX," ").concat(t[s].ctrPosY," ").concat(t[s].posX," ").concat(t[s].posY," C ").concat(t[s].ctr2PosX," ").concat(t[s].ctr2PosY," "):e+="".concat(t[s].ctrPosX," ").concat(t[s].ctrPosY," ").concat(t[s].posX," ").concat(t[s].posY);return console.log(e),e},s=function(e){e.stopPropagation(),t.setPathid(t.path.id)},n=v.a.throttle((function(t,e){t.stopPropagation();var s=m(t),o=s.x,c=s.y,n=e.nodes.reduce((function(t,s,o){return o===e.nodes.length-1?t.push(s.ctrPosX,s.ctrPosY,s.posX,s.posY):t.push(s.posX,s.posY,s.ctrPosX,s.ctrPosY),t}),[]).flat(1),i=new Y.a(n);X(i);var r=i.project({x:o,y:c});j({posX:r.x,posY:r.y,ctrPosX:r.x,ctrPosY:r.y,t:r.t})}),50),i=Object(c.useState)(!1),r=Object(a.a)(i,2),l=r[0],u=r[1],d=Object(c.useState)(),p=Object(a.a)(d,2),h=p[0],j=p[1],b=Object(c.useState)(),P=Object(a.a)(b,2),x=P[0],X=P[1],g=t.path,k=g.id,N=g.nodes;if(!l)return Object(o.jsx)(c.Fragment,{children:Object(o.jsx)("path",{onDoubleClick:function(e){e.stopPropagation(),"mouse"===t.currentTool&&u(!0)},onClick:s,d:e(N),strokeWidth:t.path.strokeWidth,stroke:t.path.stroke,fill:t.path.fill})});var y=function(){for(var t=[],s=null,o=0;o+1<N.length;o++){if(0!==o&&o+1!==N.length){var c=N[o];s={posX:c.posX,posY:c.posY,ctrPosX:c.ctr2PosX,ctrPosY:c.ctr2PosY}}var n=e([s||N[o],N[o+1]]);t.push({attrD:n,nodes:[s||N[o],N[o+1]]})}return t}();return Object(o.jsxs)(c.Fragment,{children:[y.map((function(e){return Object(o.jsx)(c.Fragment,{children:Object(o.jsx)("path",{onClick:s,d:e.attrD,onMouseOver:function(t){return n(t,e)},strokeWidth:t.path.strokeWidth,stroke:t.path.stroke,fill:t.path.fill},e.attrD)})})),N.map((function(t,e){return Object(o.jsx)(O,{node:t,id:e,pathId:k})})),h&&Object(o.jsx)(O,{node:h,id:-1,pathId:-1,onClick:function(){var t=null===x||void 0===x?void 0:x.split(h.t),e=null===t||void 0===t?void 0:t.left.points;if(t&&e){var s=N.findIndex((function(t){return t.posX===(null===x||void 0===x?void 0:x.points[0].x)&&t.posY===(null===x||void 0===x?void 0:x.points[0].y)})),o={posX:e[0].x,posY:e[0].y,ctrPosX:s?f.pathList[k].nodes[s].ctrPosX:e[1].x,ctrPosY:s?f.pathList[k].nodes[s].ctrPosY:e[1].y,ctr2PosX:s?e[1].x:void 0,ctr2PosY:s?e[1].y:void 0},c={posX:e[3].x,posY:e[3].y,ctrPosX:e[2].x,ctrPosY:e[2].y,ctr2PosX:0,ctr2PosY:0};f.setNodes(k,s,o),o={posX:(e=null===t||void 0===t?void 0:t.right.points)[3].x,posY:e[3].y,ctrPosX:e[2].x,ctrPosY:e[2].y,ctr2PosX:f.pathList[k].nodes[s+1].ctr2PosX||void 0,ctr2PosY:f.pathList[k].nodes[s+1].ctr2PosY||void 0},c.ctr2PosX=e[1].x,c.ctr2PosY=e[1].y,f.setNodes(k,s+1,o),f.addNodes(k,c.posX,c.posY,c.ctrPosX,c.ctrPosY,c.ctr2PosX,c.ctr2PosY,s+1),j(null)}},onMouseLeave:function(){return j(null)}})]})})),k=(s(28),function(t){Object(c.useEffect)((function(){var t;if(s){var e=null===s||void 0===s||null===(t=s.current)||void 0===t?void 0:t.getBoundingClientRect();e&&(f.editorInfo.top=e.top,f.editorInfo.left=e.left,v(e))}}),[]),Object(c.useEffect)((function(){"pen"!==t.currentTool&&(N({posX:-1,posY:-1}),d(-1))}),[t.currentTool]);var e,s=Object(c.useRef)(null),n=Object(c.useRef)(!0),i=Object(c.useState)(-1),r=Object(a.a)(i,2),u=r[0],d=r[1],p=Object(c.useState)(f.editorInfo),P=Object(a.a)(p,2),O=P[0],v=P[1],X=Object(c.useState)({posX:-1,posY:-1}),Y=Object(a.a)(X,2),k=Y[0],N=Y[1],y=f.pathList,S=f.mouseState.pathid,L=f.mouseState.nodeid,I=Object(c.useState)(y[f.mouseState.pathid].nodes[f.mouseState.nodeid]),C=Object(a.a)(I,2),M=C[0],T=C[1];Object(c.useEffect)((function(){f.setNodes(f.mouseState.pathid,f.mouseState.nodeid,M)}),[M]);var w=x.debounce((function(t){if(t.stopPropagation(),f.mouseState.drugging){var e=m(t),s=e.x,o=e.y;switch(f.mouseState.type){case h:T(Object(l.a)(Object(l.a)({},M),{},{posX:s,posY:o}));break;case j:T(Object(l.a)(Object(l.a)({},M),{},{ctrPosX:s,ctrPosY:o}));break;case b:T(Object(l.a)(Object(l.a)({},M),{},{ctr2PosX:s,ctr2PosY:o}))}}}),5,{trailing:!0});return Object(o.jsx)("div",{className:"editor-container",children:Object(o.jsx)("svg",{ref:s,className:"editor-svg",width:O.width,height:O.height,onMouseDown:function(t){t.stopPropagation(),S=f.mouseState.pathid,L=f.mouseState.nodeid;var e=f.pathList[S].nodes[L];T({posX:e.posX,posY:e.posY,ctrPosX:e.ctrPosX,ctrPosY:e.ctrPosY,ctr2PosX:e.ctr2PosX,ctr2PosY:e.ctr2PosY})},onMouseMove:w,onMouseUp:function(t){t.stopPropagation(),f.setMouseState(h,!1,S,L)},onDoubleClick:function(){clearTimeout(e),n.current=!1,d(-1)},onClick:function(s){s.stopPropagation(),clearTimeout(e),e=setTimeout((function(){switch(t.currentTool){case"pen":if(n.current){var e=u,o=m(s),c=o.x,i=o.y;if(-1===e){if(!(k.posX>-1&&k.posY>-1))return void N({posX:c,posY:i});e=f.addPath(),d(e),f.addNodes(e,k.posX,k.posY),N({posX:-1,posY:-1})}f.addNodes(e,c,i)}else n.current=!0}}),300)},children:y.map((function(e){return Object(o.jsx)(g,{path:e,setPathid:t.set,currentTool:t.currentTool},e.id)}))})})}),N=(s(29),Object(P.a)((function(t){var e=function(e){var s=e.target.name,o=e.target.value;f.setStateInfo(t.currentPathid,s,o)},s=f.pathList[t.currentPathid];return Object(o.jsx)(c.Fragment,{children:Object(o.jsxs)("div",{className:"statusContainer",children:[Object(o.jsx)("h4",{children:"\u72b6\u6001\u680f"}),Object(o.jsxs)("label",{className:"statusinput",children:[Object(o.jsx)("span",{children:"PositionX:"}),Object(o.jsx)("input",{type:"number",name:"X",value:s.nodes[0].posX,onChange:e})]}),Object(o.jsxs)("label",{className:"statusinput",children:[Object(o.jsx)("span",{children:"PositionY:"}),Object(o.jsx)("input",{type:"number",name:"Y",value:s.nodes[0].posY,onChange:e})]}),Object(o.jsxs)("label",{className:"statusinput",children:[Object(o.jsx)("span",{children:"fill:"}),Object(o.jsx)("input",{type:"color",name:"fill",value:s.fill,onChange:e})]}),Object(o.jsxs)("label",{className:"statusinput",children:[Object(o.jsx)("span",{children:"stroke Width:"}),Object(o.jsx)("input",{type:"number",name:"strokeWidth",min:"0",max:"40",value:s.strokeWidth,onChange:e})]}),Object(o.jsxs)("label",{className:"statusinput",children:[Object(o.jsx)("span",{children:"stroke:"}),Object(o.jsx)("input",{type:"color",name:"stroke",value:s.stroke,onChange:e})]})]})})}))),y=(s(30),s(31),s.p+"static/media/circle.292ce4e1.svg"),S=s.p+"static/media/pen.4de46a1c.svg",L=s.p+"static/media/mouse.dfeff54d.svg",I=s.p+"static/media/line.86048c7a.svg",C=s.p+"static/media/rectangle.d8ea8f58.svg",M=function(t){function e(e){t.set(e.target.id)}return Object(o.jsxs)("div",{className:"toolbar",children:[Object(o.jsx)("div",{className:"toolitem",onClick:e,children:Object(o.jsx)("img",{className:"mouse"===t.currentTool?"itmeIconselect":"itmeIcon",id:"mouse",alt:"mouse",src:L})}),Object(o.jsx)("div",{className:"toolitem",onClick:e,children:Object(o.jsx)("img",{className:"circle"===t.currentTool?"itmeIconselect":"itmeIcon",id:"circle",alt:"circle",src:y})}),Object(o.jsx)("div",{className:"toolitem",onClick:e,children:Object(o.jsx)("img",{className:"rectangle"===t.currentTool?"itmeIconselect":"itmeIcon",id:"rectangle",alt:"rectangle",src:C})}),Object(o.jsx)("div",{className:"toolitem",onClick:e,children:Object(o.jsx)("img",{className:"line"===t.currentTool?"itmeIconselect":"itmeIcon",id:"line",alt:"line",src:I})}),Object(o.jsx)("div",{className:"toolitem",onClick:e,children:Object(o.jsx)("img",{className:"pen"===t.currentTool?"itmeIconselect":"itmeIcon",id:"pen",alt:"pen",src:S})})]})},T=(s(32),function(){var t=Object(c.useState)("mouse"),e=Object(a.a)(t,2),s=e[0],n=e[1],i=Object(c.useState)(0),r=Object(a.a)(i,2),l=r[0],u=r[1];return Object(o.jsxs)("div",{className:"basic-container",children:[Object(o.jsx)(M,{currentTool:s,set:n}),Object(o.jsx)(k,{currentTool:s,currentPathid:l,set:u}),Object(o.jsx)(N,{currentPathid:l})]})});s(33);var w=function(){return Object(o.jsx)("div",{className:"App",children:Object(o.jsx)(T,{})})},W=function(t){t&&t instanceof Function&&s.e(3).then(s.bind(null,35)).then((function(e){var s=e.getCLS,o=e.getFID,c=e.getFCP,n=e.getLCP,i=e.getTTFB;s(t),o(t),c(t),n(t),i(t)}))};r.a.render(Object(o.jsx)(n.a.StrictMode,{children:Object(o.jsx)(w,{})}),document.getElementById("root")),W()}},[[34,1,2]]]);
//# sourceMappingURL=main.0084702b.chunk.js.map