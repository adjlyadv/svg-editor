(this["webpackJsonpsvg-editor"]=this["webpackJsonpsvg-editor"]||[]).push([[0],{26:function(t,o,e){},32:function(t,o,e){},33:function(t,o,e){},34:function(t,o,e){},35:function(t,o,e){},36:function(t,o,e){},37:function(t,o,e){},38:function(t,o,e){},39:function(t,o,e){"use strict";e.r(o);var c=e(0),s=e(1),r=e.n(s),n=e(17),a=e.n(n),i=(e(26),e(4)),p=e(3),d=e(12),u=e.n(d),l=e(18),h=e(9),P=e(19),b=e(13),j=e(2),f=0,Y=1,X=2,x=new function t(){var o=this;Object(h.a)(this,t),this.editorInfo={width:800,height:600,left:0,top:0},this.mouseState={type:f,drugging:!1,pathid:-1,nodeid:-1},this.currentTool="mouse",this.pathList=[],this.editingPathId=-1,this.setPathBbox=function(t,e){var c=t.getBBox(),s=c.x+(c.width>>1),r=c.y+(c.height>>1);o.pathList[e].centerPoint={ctrx:s,ctry:r},o.pathList[e].border=[{ctrx:c.x,ctry:c.y},{ctrx:c.x+c.width,ctry:c.y},{ctrx:c.x+c.width,ctry:c.y+c.height},{ctrx:c.x,ctry:c.y+c.height}],g.update(o.pathList[e])},this.initPathList=function(t,e){o.pathList[t]=e},this.addPath=function(t){return o.pathList.push({id:o.pathList.length,nodes:[],strokeWidth:5,stroke:"#000000",fill:"none",type:t||0,centerPoint:{ctrx:-1,ctry:-1},rotate:0,border:[{ctrx:-1,ctry:-1},{ctrx:-1,ctry:-1},{ctrx:-1,ctry:-1},{ctrx:-1,ctry:-1}]}),o.pathList.length-1},this.deletePath=function(t){o.pathList=o.pathList.splice(t,1),g.remove(t)},this.setEditingPath=function(t){o.editingPathId=t},this.setNodes=function(t,e,c){o.pathList[t]&&(o.pathList[t].nodes[e]=c,g.update(o.pathList[t]))},this.addNodes=function(t,e,c,s,r,n,a,i,p){var d=o.pathList[t].nodes.length,u=o.pathList[t].type;0===d||p?(u?o.pathList[t].nodes.push({posX:e,posY:c,ctrPosX:s||e,ctrPosY:r||c,ctr2PosX:n,ctr2PosY:a}):o.pathList[t].nodes.push({posX:e,posY:c,ctrPosX:s||e,ctrPosY:r||c}),0===d?g.add(o.pathList[t]):g.update(o.pathList[t])):(o.pathList[t].nodes=[].concat(Object(b.a)(o.pathList[t].nodes.slice(0,i||d)),[{posX:e,posY:c,ctrPosX:s||e,ctrPosY:r||c,ctr2PosX:n,ctr2PosY:a}],Object(b.a)(o.pathList[t].nodes.slice(i||d))),g.update(o.pathList[t]))},this.setMouseState=function(t,e,c,s){o.mouseState.pathid=c,o.mouseState.nodeid=s,o.mouseState.type=t,o.mouseState.drugging=e},this.setCurrentTool=function(t){o.currentTool=t},this.movePath=function(t,e,c){var s,r=Object(P.a)(o.pathList[t].nodes);try{for(r.s();!(s=r.n()).done;){var n=s.value;n.posX+=e,n.posY+=c,n.ctrPosX+=e,n.ctrPosY+=c,n.ctr2PosY&&n.ctr2PosX&&(n.ctr2PosX+=e,n.ctr2PosY+=c)}}catch(a){r.e(a)}finally{r.f()}g.update(o.pathList[t])},this.setBorder=function(t,e){o.pathList[t].border=e},this.setStateInfo=function(t,e,c){switch(e){case"X":var s=o.pathList[t].nodes[0].posX;o.movePath(t,Number(c)-s,0);break;case"Y":var r=o.pathList[t].nodes[0].posY;o.movePath(t,0,Number(c)-r);break;case"fill":o.pathList[t].fill=c;break;case"strokeWidth":o.pathList[t].strokeWidth=Number(c);break;case"stroke":o.pathList[t].stroke=c;break;case"rotate":o.pathList[t].rotate=Number(c)}g.update(o.pathList[t])},Object(j.k)(this)},m=e(6),O=e.n(m),g=new function t(){var o=this;Object(h.a)(this,t),this.dbName="svgData",this.version=1,this.tableName="svgPath",this.db=null,this.openDB=function(){return new Promise((function(t,e){var c=window.indexedDB.open(o.dbName,o.version);c.onsuccess=function(e){console.log("\u6210\u529f\u6253\u5f00\u6570\u636e\u5e93"),o.db=e.target.result,t(1)},c.onupgradeneeded=function(t){console.log("\u6210\u529f\u65b0\u5efa\u6570\u636e\u5e93"),o.db=t.target.result,o.create_table(o.db)},c.onerror=function(t){console.log("\u6570\u636e\u5e93\u6253\u5f00\u62a5\u9519"),e(1)}}))},this.create_table=function(t){t.objectStoreNames.contains(o.tableName)||t.createObjectStore(o.tableName,{keyPath:"id"}).createIndex("id","id",{unique:!0})},this.add=function(t){if(o.db){var e=Object(j.m)(t),c=o.db.transaction([o.tableName],"readwrite").objectStore(o.tableName).add(e);c.onsuccess=function(t){console.log("\u6570\u636e\u5199\u5165\u6210\u529f")},c.onerror=function(t){console.log("\u6570\u636e\u5199\u5165\u5931\u8d25")}}},this.readAll=function(){return new Promise((function(t,e){o.db?o.db.transaction(o.tableName).objectStore(o.tableName).openCursor().onsuccess=function(o){var e=o.target.result;e?(x.initPathList(e.key,e.value),e.continue()):(console.log("\u6ca1\u6709\u66f4\u591a\u6570\u636e\u4e86\uff01"),t(1))}:e()}))},this.update=m.debounce((function(t){if(o.db){var e=Object(j.m)(t),c=o.db.transaction([o.tableName],"readwrite").objectStore(o.tableName).put(e);c.onsuccess=function(t){console.log("\u6570\u636e\u66f4\u65b0\u6210\u529f")},c.onerror=function(t){console.log("\u6570\u636e\u66f4\u65b0\u5931\u8d25")}}}),1e3,{maxWait:1e4}),this.remove=function(t){o.db&&(o.db.transaction([o.tableName],"readwrite").objectStore(o.tableName).delete(t).onsuccess=function(t){console.log("\u6570\u636e\u5220\u9664\u6210\u529f")})}};function v(t){var o=x.editorInfo;return{x:t.clientX-o.left,y:t.clientY-o.top}}function y(t){return{ctr2PosX:2*t.posX-t.ctrPosX,ctr2PosY:2*t.posY-t.ctrPosY}}function k(t){var o=t.posX,e=t.posY,c=t.ctrPosY,s=t.ctrPosX,r=Math.sqrt((o-s)*(o-s)+(e-c)*(e-c)),n=.552284749831*r,a=[];return a[0]={posX:o,posY:e+r,ctrPosX:o+n,ctrPosY:e+r,ctr2PosX:o-n,ctr2PosY:e+r},a[1]={posX:o+r,posY:e,ctrPosX:o+r,ctrPosY:e+n,ctr2PosX:o+r,ctr2PosY:e-n},a[2]={posX:o,posY:e-r,ctrPosX:o+n,ctrPosY:e-r,ctr2PosX:o-n,ctr2PosY:e-r},a[3]={posX:o-r,posY:e,ctrPosX:o-r,ctrPosY:e-n,ctr2PosX:o-r,ctr2PosY:e+n},a}function N(t){var o=t.posX,e=t.posY,c=t.ctrPosY,s=t.ctrPosX,r=[];return r[0]={posX:o,posY:e,ctrPosX:o,ctrPosY:e,ctr2PosX:o,ctr2PosY:e},r[1]={posX:s,posY:e,ctrPosX:s,ctrPosY:e,ctr2PosX:s,ctr2PosY:e},r[2]={posX:s,posY:c,ctrPosX:s,ctrPosY:c,ctr2PosX:s,ctr2PosY:c},r[3]={posX:o,posY:c,ctrPosX:o,ctrPosY:c,ctr2PosX:o,ctr2PosY:c},r}var _=e(7),L=Object(_.a)((function(t){if(-1===t.id)return Object(c.jsx)("circle",{onClick:t.onClick,onMouseLeave:t.onMouseLeave,className:"point-control-add",cx:t.node.posX,cy:t.node.posY});var o=x.pathList[t.pathId].nodes[t.id],e=x.mouseState,r=e.pathid===t.pathId&&e.nodeid===t.id,n=x.currentTool,a=function(o,e){switch("pen_new_path"===n&&(x.pathList[t.pathId].type=1),o){case f:x.setMouseState(f,!0,t.pathId,t.id);break;case Y:x.setMouseState(Y,!0,t.pathId,t.id);break;case X:x.setMouseState(X,!0,t.pathId,t.id)}};return Object(c.jsxs)(s.Fragment,{children:[Object(c.jsx)("circle",{className:"point-control",onMouseDown:function(t){return a(f)},cx:o.posX,cy:o.posY}),r&&Object(c.jsx)("line",{x1:o.posX,y1:o.posY,x2:o.ctrPosX,y2:o.ctrPosY,stroke:"#555",strokeWidth:"1"}),r&&Object(c.jsx)("circle",{className:"point-control",onMouseDown:function(t){return a(Y)},cx:o.ctrPosX,cy:o.ctrPosY}),r&&e.nodeid===t.id&&o.ctr2PosX&&o.ctr2PosY&&Object(c.jsx)("circle",{className:"point-control",onMouseDown:function(t){return a(X)},cx:o.ctr2PosX,cy:o.ctr2PosY}),r&&e.nodeid===t.id&&o.ctr2PosX&&o.ctr2PosY&&Object(c.jsx)("line",{x1:o.posX,y1:o.posY,x2:o.ctr2PosX,y2:o.ctr2PosY,stroke:"#555",strokeWidth:"1"})]})})),I=e(20),S=e.n(I),w=Object(_.a)((function(t){var o=function(t,o){var e="",c=t.length;if(1===c)return e;for(var s=0;s<t.length;s++)0===s?e+="M ".concat(t[s].posX," ").concat(t[s].posY," C ").concat(t[s].ctrPosX," ").concat(t[s].ctrPosY," "):s+1<=t.length-1?e+="".concat(t[s].ctrPosX," ").concat(t[s].ctrPosY," ").concat(t[s].posX," ").concat(t[s].posY," C ").concat(t[s].ctr2PosX," ").concat(t[s].ctr2PosY," "):e+="".concat(t[s].ctrPosX," ").concat(t[s].ctrPosY," ").concat(t[s].posX," ").concat(t[s].posY," ");if(o){var r=y(t[0]),n=r.ctr2PosX,a=r.ctr2PosY;e+="C ".concat(t[c-1].ctr2PosX," ").concat(t[c-1].ctr2PosY," \n          ").concat(t[0].ctr2PosX?t[0].ctr2PosX:n," ").concat(t[0].ctr2PosY?t[0].ctr2PosY:a," ").concat(t[0].posX," ").concat(t[0].posY," z")}return e},e=function(o){o.stopPropagation(),x.setEditingPath(t.path.id),x.setPathBbox(o.target,t.path.id)},r=O.a.throttle((function(o,e){if(o.stopPropagation(),"pen_add_node"===t.currentTool){var c=v(o),s=c.x,r=c.y,n=e.nodes.reduce((function(t,o,c){return c===e.nodes.length-1?t.push(o.ctrPosX,o.ctrPosY,o.posX,o.posY):t.push(o.posX,o.posY,o.ctrPosX,o.ctrPosY),t}),[]).flat(1),a=new S.a(n);P(a);var i=a.project({x:s,y:r});d({posX:i.x,posY:i.y,ctrPosX:i.x,ctrPosY:i.y,t:i.t})}}),50),n=Object(s.useState)(),a=Object(i.a)(n,2),p=a[0],d=a[1],u=Object(s.useState)(),l=Object(i.a)(u,2),h=l[0],P=l[1],b=t.path,j=b.id,f=b.nodes;if("pen_add_node"===t.currentTool){var Y=function(){for(var e=[],c=null,s=0;s+1<f.length;s++){if(0!==s){var r=f[s];c={posX:r.posX,posY:r.posY,ctrPosX:r.ctr2PosX,ctrPosY:r.ctr2PosY}}var n=[c||f[s],f[s+1]],a=o(n,!1);e.push({attrD:a,nodes:n})}if(t.path.type){var i=f[f.length-1],p=[{posX:i.posX,posY:i.posY,ctrPosX:i.ctr2PosX,ctrPosY:i.ctr2PosY},{posX:(i=f[0]).posX,posY:i.posY,ctrPosX:i.ctr2PosX,ctrPosY:i.ctr2PosY}],d=o(p,!1);e.push({attrD:d,nodes:p})}return e}();return Object(c.jsxs)(s.Fragment,{children:[Y.map((function(o){return Object(c.jsx)(s.Fragment,{children:Object(c.jsx)("path",{onClick:e,d:o.attrD,onMouseOver:function(t){return r(t,o)},strokeWidth:t.path.strokeWidth,stroke:t.path.stroke,fill:t.path.fill},o.attrD)})})),f.length&&f.map((function(t,o){return Object(c.jsx)(L,{node:t,id:o,pathId:j})})),p&&Object(c.jsx)(L,{node:p,id:-1,pathId:-1,onClick:function(){if("pen_add_node"===t.currentTool){var o=null===h||void 0===h?void 0:h.split(p.t),e=null===o||void 0===o?void 0:o.left.points;if(o&&e){var c=f.findIndex((function(t){return t.posX===(null===h||void 0===h?void 0:h.points[0].x)&&t.posY===(null===h||void 0===h?void 0:h.points[0].y)})),s={posX:e[0].x,posY:e[0].y,ctrPosX:c?x.pathList[j].nodes[c].ctrPosX:e[1].x,ctrPosY:c?x.pathList[j].nodes[c].ctrPosY:e[1].y,ctr2PosX:c?e[1].x:void 0,ctr2PosY:c?e[1].y:void 0},r={posX:e[3].x,posY:e[3].y,ctrPosX:e[2].x,ctrPosY:e[2].y,ctr2PosX:0,ctr2PosY:0};x.setNodes(j,c,s),s={posX:(e=null===o||void 0===o?void 0:o.right.points)[3].x,posY:e[3].y,ctrPosX:e[2].x,ctrPosY:e[2].y,ctr2PosX:x.pathList[j].nodes[c+1].ctr2PosX||void 0,ctr2PosY:x.pathList[j].nodes[c+1].ctr2PosY||void 0},r.ctr2PosX=e[1].x,r.ctr2PosY=e[1].y,x.setNodes(j,c+1,s),x.addNodes(j,r.posX,r.posY,r.ctrPosX,r.ctrPosY,r.ctr2PosX,r.ctr2PosY,c+1),d(null)}}},onMouseLeave:function(){return d(null)}})]})}if("mouse_rotate_path"===t.currentTool&&x.editingPathId===j){var X="rotate(".concat(t.path.rotate,",").concat(t.path.centerPoint.ctrx,",").concat(t.path.centerPoint.ctry,")"),m="M ".concat(t.path.border[0].ctrx," ").concat(t.path.border[0].ctry)+" C ".concat(t.path.border[0].ctrx," ").concat(t.path.border[0].ctry," ").concat(t.path.border[0].ctrx," ").concat(t.path.border[0].ctry," ").concat(t.path.border[1].ctrx," ").concat(t.path.border[1].ctry)+" C ".concat(t.path.border[1].ctrx," ").concat(t.path.border[1].ctry," ").concat(t.path.border[1].ctrx," ").concat(t.path.border[1].ctry," ").concat(t.path.border[2].ctrx," ").concat(t.path.border[2].ctry)+" C ".concat(t.path.border[2].ctrx," ").concat(t.path.border[2].ctry," ").concat(t.path.border[2].ctrx," ").concat(t.path.border[2].ctry," ").concat(t.path.border[3].ctrx," ").concat(t.path.border[3].ctry)+" C ".concat(t.path.border[3].ctrx," ").concat(t.path.border[3].ctry," ").concat(t.path.border[3].ctrx," ").concat(t.path.border[3].ctry," ").concat(t.path.border[0].ctrx," ").concat(t.path.border[0].ctry);return Object(c.jsxs)(s.Fragment,{children:[Object(c.jsx)("path",{transform:X,onClick:e,d:o(f,!!t.path.type),strokeWidth:t.path.strokeWidth,stroke:t.path.stroke,fill:t.path.fill}),Object(c.jsx)("path",{d:m,transform:X,strokeWidth:"2",stroke:"#55f",fill:"none",strokeDasharray:"5"})]})}return Object(c.jsxs)(s.Fragment,{children:[Object(c.jsx)("path",{onClick:e,d:o(f,!!t.path.type),strokeWidth:t.path.strokeWidth,stroke:t.path.stroke,fill:t.path.fill}),j===x.editingPathId&&f.length&&f.map((function(t,o){return Object(c.jsx)(L,{node:t,id:o,pathId:j},o)}))]})})),C=(e(32),function(t){Object(s.useEffect)((function(){var t;if(o){var e=null===o||void 0===o||null===(t=o.current)||void 0===t?void 0:t.getBoundingClientRect();e&&(x.editorInfo.top=e.top,x.editorInfo.left=e.left,j(e)),function(){var t=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.openDB();case 3:return t.next=5,g.readAll();case 5:F({posX:-1,posY:-1,ctrPosX:-1,ctrPosY:-1}),console.log("\u52a0\u8f7d\u6570\u636e\u7ed3\u675f"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log("\u52a0\u8f7d\u5931\u8d25");case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}()()}}),[]);var o=Object(s.useRef)(null),e=Object(s.useRef)(!1),r=Object(s.useState)(-1),n=Object(i.a)(r,2),a=n[0],d=n[1],h=Object(s.useState)(x.editorInfo),P=Object(i.a)(h,2),b=P[0],j=P[1],O=Object(s.useState)(!1),_=Object(i.a)(O,2),L=_[0],I=_[1],S=x.pathList,C=x.mouseState.pathid,T=x.mouseState.nodeid,M=Object(s.useState)({posX:-1,posY:-1,ctrPosX:-1,ctrPosY:-1}),W=Object(i.a)(M,2),D=W[0],F=W[1];Object(s.useEffect)((function(){x.setNodes(x.mouseState.pathid,x.mouseState.nodeid,D)}),[D]),Object(s.useEffect)((function(){if("pen_new_path"!==t.currentTool){var o=a;-1!==o&&x.pathList[o].nodes.length<2?(x.deletePath(o),e.current=!1,d(-1)):-1!==o&&x.pathList[o].nodes.length>=2&&(e.current=!1,d(-1))}}),[t.currentTool,a]);var B,E=Object(s.useState)(!1),A=Object(i.a)(E,2),R=A[0],q=A[1],J=Object(s.useState)({posX:-1,posY:-1,ctrPosX:-1,ctrPosY:-1}),z=Object(i.a)(J,2),U=z[0],Z=z[1],G=Object(s.useState)({posX:-1,posY:-1,ctrPosX:-1,ctrPosY:-1}),H=Object(i.a)(G,2),K=H[0],Q=H[1],V=Object(s.useState)({posX:-1,posY:-1,ctrPosX:-1,ctrPosY:-1}),$=Object(i.a)(V,2),tt=$[0],ot=$[1],et=Object(s.useState)({posX:-1,posY:-1}),ct=Object(i.a)(et,2),st=ct[0],rt=ct[1],nt=Object(s.useState)(!1),at=Object(i.a)(nt,2),it=at[0],pt=at[1],dt=m.throttle((function(o){o.stopPropagation();var c=v(o),s=c.x,r=c.y;switch(t.currentTool){case"mouse_drag_path":if(!it)return;var n=s-st.posX,a=r-st.posY,i=x.editingPathId;x.movePath(i,n,a),rt({posX:s,posY:r});break;case"mouse_rotate_path":if(R){var d=x.editingPathId,u=x.pathList[d].centerPoint,l=u.ctrx,h=u.ctry;Z(Object(p.a)(Object(p.a)({},U),{},{ctrPosX:s,ctrPosY:r}));var P=function(t){var o=t.posX*t.ctrPosX+t.posY*t.ctrPosY,e=t.posX*t.ctrPosY-t.posY*t.ctrPosY;return(Math.atan2(e,o)/Math.PI*180+360)%360}({posX:U.posX-l,posY:U.posY-h,ctrPosX:U.ctrPosX-l,ctrPosY:U.ctrPosY-h});x.setStateInfo(d,"rotate",P.toString())}break;case"rectangle":case"circle":R&&Z(Object(p.a)(Object(p.a)({},U),{},{ctrPosX:s,ctrPosY:r}));break;case"pen_drag_node":if(!x.mouseState.drugging)return;switch(x.mouseState.type){case f:F(Object(p.a)(Object(p.a)({},D),{},{posX:s,posY:r}));break;case Y:F(Object(p.a)(Object(p.a)({},D),{},{ctrPosX:s,ctrPosY:r}));break;case X:F(Object(p.a)(Object(p.a)({},D),{},{ctr2PosX:s,ctr2PosY:r}))}break;case"pen_new_path":e.current&&Q(Object(p.a)(Object(p.a)({},K),{},{ctrPosX:s,ctrPosY:r}))}}),5,{trailing:!0});return Object(c.jsx)("div",{className:"editor-container",children:Object(c.jsxs)("svg",{ref:o,className:"editor-svg",width:b.width,height:b.height,onMouseDown:function(o){o.stopPropagation();var c=v(o),s=c.x,r=c.y;switch(t.currentTool){case"mouse_drag_path":-1!==x.editingPathId&&(pt(!0),rt({posX:s,posY:r}));break;case"mouse_rotate_path":-1!==x.editingPathId&&(q(!0),Z({posX:s,posY:r,ctrPosX:s,ctrPosY:r}));break;case"rectangle":case"circle":q(!0),Z({posX:s,posY:r,ctrPosX:s,ctrPosY:r});break;case"pen_drag_node":if(C=x.mouseState.pathid,T=x.mouseState.nodeid,-1!==C&&-1!==T){var n=x.pathList[C].nodes[T];F(Object(p.a)({},n))}break;case"pen_new_path":e.current||(e.current=!0,I(!0),ot({posX:s,posY:r,ctrPosX:s,ctrPosY:r,ctr2PosX:s,ctr2PosY:r})),Q({posX:s,posY:r,ctrPosX:s,ctrPosY:r,ctr2PosX:s,ctr2PosY:r})}},onMouseMove:dt,onMouseUp:function(o){o.stopPropagation(),clearTimeout(B),B=setTimeout((function(){switch(t.currentTool){case"mouse_drag_path":pt(!1);break;case"mouse_rotate_path":if(R){var o=x.editingPathId;!function(t){var o=x.pathList[t],e=o.rotate,c=o.centerPoint,s=o.border,r=e*Math.PI/180,n=Math.cos(r),a=Math.sin(r),i={posX:-1,posY:-1,ctrPosX:-1,ctrPosY:-1,ctr2PosX:-1,ctr2PosY:-1};o.nodes.forEach((function(o,e){i.posX=(o.posX-c.ctrx)*n-(o.posY-c.ctry)*a+c.ctrx,i.posY=(o.posX-c.ctrx)*a+(o.posY-c.ctry)*n+c.ctry,i.ctrPosX=(o.ctrPosX-c.ctrx)*n-(o.ctrPosY-c.ctry)*a+c.ctrx,i.ctrPosY=(o.ctrPosX-c.ctrx)*a+(o.ctrPosY-c.ctry)*n+c.ctry,o.ctr2PosX&&o.ctr2PosY?(i.ctr2PosX=(o.ctr2PosX-c.ctrx)*n-(o.ctr2PosY-c.ctry)*a+c.ctrx,i.ctr2PosY=(o.ctr2PosX-c.ctrx)*a+(o.ctr2PosY-c.ctry)*n+c.ctry,x.setNodes(t,e,i)):x.setNodes(t,e,{posX:i.posX,posY:i.posY,ctrPosX:i.ctrPosX,ctrPosY:i.ctrPosY})}));var p=[{ctrx:-1,ctry:-1},{ctrx:-1,ctry:-1},{ctrx:-1,ctry:-1},{ctrx:-1,ctry:-1}];s.forEach((function(t,o){p[o].ctrx=(t.ctrx-c.ctrx)*n-(t.ctry-c.ctry)*a+c.ctrx,p[o].ctry=(t.ctrx-c.ctrx)*a+(t.ctry-c.ctry)*n+c.ctry})),x.setBorder(t,p)}(o),x.setStateInfo(o,"rotate","0")}q(!1),Z({posX:-1,posY:-1,ctrPosX:-1,ctrPosY:-1});break;case"rectangle":if(R){var c=a;if(-1===a)c=x.addPath(1),N(U).forEach((function(t){x.addNodes(c,t.posX,t.posY,t.ctrPosX,t.ctrPosY,t.ctr2PosX,t.ctr2PosY)}))}q(!1),Z({posX:-1,posY:-1,ctrPosX:-1,ctrPosY:-1});break;case"circle":if(R){var s=a;if(-1===a)s=x.addPath(1),k(U).forEach((function(t){x.addNodes(s,t.posX,t.posY,t.ctrPosX,t.ctrPosY,t.ctr2PosX,t.ctr2PosY)}))}q(!1),Z({posX:-1,posY:-1,ctrPosX:-1,ctrPosY:-1});break;case"pen_drag_node":x.setMouseState(f,!1,C,T);break;case"pen_new_path":if(!e.current)return;var r=a;if(-1===a&&(r=x.addPath(),d(r)),x.setEditingPath(r),x.pathList[r].type){var n=y(x.pathList[r].nodes[0]),i=n.ctr2PosX,u=n.ctr2PosY;return x.pathList[r].nodes[0].ctr2PosX=i,x.pathList[r].nodes[0].ctr2PosY=u,e.current=!1,void d(-1)}var l=x.pathList[r].nodes.length,h=y(K),P=h.ctr2PosX,b=h.ctr2PosY;x.addNodes(r,K.posX,K.posY,K.ctrPosX,K.ctrPosY,P,b,l),L?(ot(Object(p.a)(Object(p.a)({},K),{},{ctrPosX:P,ctrPosY:b})),I(!1)):ot(Object(p.a)({},K))}}),250)},onDoubleClick:function(){switch(clearTimeout(B),t.currentTool){case"pen_new_path":if(!e.current||-1===a)return;var o=a,c=x.pathList[o].nodes.length;x.addNodes(o,K.posX,K.posY,K.ctrPosX,K.ctrPosY,K.ctrPosX,K.ctrPosY,c,!0)}e.current=!1,d(-1)},children:[function(){if(e.current){var t=y(tt),o=t.ctr2PosX,r=t.ctr2PosY,n="M ".concat(tt.posX," ").concat(tt.posY," C ").concat(o," ").concat(r," ").concat(K.ctrPosX," ").concat(K.ctrPosY),a=0;return tt.posX!==K.posX&&tt.posY!==K.posY?(n+=" ".concat(K.posX," ").concat(K.posY),a=1):(n+=" ".concat(K.ctrPosX," ").concat(K.ctrPosY),a=0),Object(c.jsxs)(s.Fragment,{children:[Object(c.jsx)("path",{d:n,fill:"none",stroke:"#000",strokeWidth:"1"}),Object(c.jsx)("circle",{className:"point-control",cx:K.posX,cy:K.posY,stroke:"#55f",r:"10"}),Object(c.jsx)("line",{x1:K.posX,y1:K.posY,x2:K.ctrPosX,y2:K.ctrPosY,stroke:"#555",strokeWidth:a})]})}}(),S.map((function(o){return Object(c.jsx)(w,{path:o,currentTool:t.currentTool},o.id)})),function(){if(R){var o=new Array(4).fill({posX:-1,posY:-1,ctrPosX:-1,ctrPosY:-1,ctr2PosX:-1,ctr2PosY:-1});switch(t.currentTool){case"rectangle":o=N(U);break;case"circle":o=k(U)}var e="M ".concat(o[0].posX," ").concat(o[0].posY," \n      C ").concat(o[0].ctrPosX," ").concat(o[0].ctrPosY," ").concat(o[1].ctrPosX," ").concat(o[1].ctrPosY," ").concat(o[1].posX," ").concat(o[1].posY," \n      C ").concat(o[1].ctr2PosX," ").concat(o[1].ctr2PosY," ").concat(o[2].ctrPosX," ").concat(o[2].ctrPosY," ").concat(o[2].posX," ").concat(o[2].posY," \n      C ").concat(o[2].ctr2PosX," ").concat(o[2].ctr2PosY," ").concat(o[3].ctrPosX," ").concat(o[3].ctrPosY," ").concat(o[3].posX," ").concat(o[3].posY," \n      C ").concat(o[3].ctr2PosX," ").concat(o[3].ctr2PosY," ").concat(o[0].ctr2PosX," ").concat(o[0].ctr2PosY," ").concat(o[0].posX," ").concat(o[0].posY," Z");return Object(c.jsx)(s.Fragment,{children:Object(c.jsx)("path",{d:e,fill:"none",stroke:"#55f",strokeWidth:"1"})})}}()]})})}),T=(e(33),Object(_.a)((function(t){var o,e=x.editingPathId,r=function(t){var o=t.target.name,c=t.target.value;-1!==e&&x.setStateInfo(e,o,c)};return-1!==e&&(o=x.pathList[e].nodes.length?x.pathList[e]:null),Object(c.jsx)(s.Fragment,{children:Object(c.jsxs)("div",{className:"statusContainer",children:[Object(c.jsx)("h4",{children:"\u72b6\u6001\u680f"}),Object(c.jsxs)("label",{className:"statusinput",children:[Object(c.jsx)("span",{children:"PositionX:"}),Object(c.jsx)("input",{type:"number",name:"X",value:o?o.nodes[0].posX.toFixed(1):0,onChange:r})]}),Object(c.jsxs)("label",{className:"statusinput",children:[Object(c.jsx)("span",{children:"PositionY:"}),Object(c.jsx)("input",{type:"number",name:"Y",value:o?o.nodes[0].posY.toFixed(1):0,onChange:r})]}),Object(c.jsxs)("label",{className:"statusinput",children:[Object(c.jsx)("span",{children:"fill:"}),Object(c.jsx)("input",{type:"color",name:"fill",value:o&&"none"!==o.fill?o.fill:"#ffffff",onChange:r})]}),Object(c.jsxs)("label",{className:"statusinput",children:[Object(c.jsx)("span",{children:"stroke Width:"}),Object(c.jsx)("input",{type:"number",name:"strokeWidth",value:o?o.strokeWidth:0,min:"0",max:"40",onChange:r})]}),Object(c.jsxs)("label",{className:"statusinput",children:[Object(c.jsx)("span",{children:"stroke:"}),Object(c.jsx)("input",{type:"color",name:"stroke",value:o?o.stroke:"#000000",onChange:r})]})]})})}))),M=(e(34),function(t){function o(o){t.set(o.target.id)}return Object(c.jsx)("div",{className:"function",children:function(){switch(t.id){case"mouse":return[Object(c.jsx)("div",{className:"mouse_rotate_path"===t.currentTool?"functionItemSelect":"functionItem",onClick:o,id:"mouse_rotate_path",children:"Rotate Path"},0),Object(c.jsx)("div",{className:"mouse_scaling_path"===t.currentTool?"functionItemSelect":"functionItem",onClick:o,id:"mouse_scaling_path",children:"Scaling Path"},1),Object(c.jsx)("div",{className:"mouse_drag_path"===t.currentTool?"functionItemSelect":"functionItem",onClick:o,id:"mouse_drag_path",children:"Drag Path"},2)];case"pen":return[Object(c.jsx)("div",{className:"pen_add_node"===t.currentTool?"functionItemSelect":"functionItem",onClick:o,id:"pen_add_node",children:"Add Node"},0),Object(c.jsx)("div",{className:"pen_drag_node"===t.currentTool?"functionItemSelect":"functionItem",onClick:o,id:"pen_drag_node",children:"Drag Node"},1),Object(c.jsx)("div",{className:"pen_new_path"===t.currentTool?"functionItemSelect":"functionItem",onClick:o,id:"pen_new_path",children:"New Path"},2)];default:return null}}()})}),W=(e(35),e(36),e.p+"static/media/circle.292ce4e1.svg"),D=e.p+"static/media/pen.4de46a1c.svg",F=e.p+"static/media/mouse.dfeff54d.svg",B=e.p+"static/media/line.86048c7a.svg",E=e.p+"static/media/rectangle.d8ea8f58.svg",A=function(t){function o(o){t.set(o.target.id)}return Object(c.jsxs)("div",{className:"toolbar",children:[Object(c.jsx)("div",{className:"toolitem",onClick:o,children:Object(c.jsx)("img",{className:-1!==t.currentTool.indexOf("mouse")?"itmeIconselect":"itmeIcon",id:"mouse",alt:"mouse",src:F})}),Object(c.jsx)("div",{className:"toolitem",onClick:o,children:Object(c.jsx)("img",{className:"circle"===t.currentTool?"itmeIconselect":"itmeIcon",id:"circle",alt:"circle",src:W})}),Object(c.jsx)("div",{className:"toolitem",onClick:o,children:Object(c.jsx)("img",{className:"rectangle"===t.currentTool?"itmeIconselect":"itmeIcon",id:"rectangle",alt:"rectangle",src:E})}),Object(c.jsx)("div",{className:"toolitem",onClick:o,children:Object(c.jsx)("img",{className:"line"===t.currentTool?"itmeIconselect":"itmeIcon",id:"line",alt:"line",src:B})}),Object(c.jsx)("div",{className:"toolitem",onClick:o,children:Object(c.jsx)("img",{className:-1!==t.currentTool.indexOf("pen")?"itmeIconselect":"itmeIcon",id:"pen",alt:"pen",src:D})})]})},R=(e(37),function(){var t=Object(s.useState)("mouse"),o=Object(i.a)(t,2),e=o[0],r=o[1],n=function(t){x.setCurrentTool(t),r(t)};return Object(c.jsxs)("div",{className:"basic-container",children:[Object(c.jsx)(A,{currentTool:e,set:n}),-1===e.indexOf("mouse")?null:Object(c.jsx)(M,{currentTool:e,set:n,id:"mouse"}),-1===e.indexOf("pen")?null:Object(c.jsx)(M,{currentTool:e,set:n,id:"pen"}),Object(c.jsx)(C,{currentTool:e}),Object(c.jsx)(T,{})]})});e(38);var q=function(){return Object(c.jsx)("div",{className:"App",children:Object(c.jsx)(R,{})})},J=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,40)).then((function(o){var e=o.getCLS,c=o.getFID,s=o.getFCP,r=o.getLCP,n=o.getTTFB;e(t),c(t),s(t),r(t),n(t)}))};a.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(q,{})}),document.getElementById("root")),J()}},[[39,1,2]]]);
//# sourceMappingURL=main.f0c80005.chunk.js.map